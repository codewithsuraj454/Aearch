<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aearch</title>
<meta name="title" content="Aerach | Search Over 200,000+ Indexed Pages & Resources">
<meta name="description" content="Aerach connects you to a vast digital universe with over 200,000 indexed pages. Our precision-tuned search engine ensures you find relevant data, guides, and resources in milliseconds. Search smarter and faster today.">

<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="googlebot" content="index, follow">
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://aearch.netlify.app/">
<meta property="og:title" content="Aearch - Fast & Private Search Engine">
<meta property="og:description" content="Modern search engine for web, images, videos, and files. Fast, clean, and powerful search results.">
<meta property="og:site_name" content="Aearch">
<meta property="og:locale" content="en_US">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://aearch.netlify.app/">
<meta property="twitter:title" content="MiniSearch - Fast & Private Search Engine">
<meta property="twitter:description" content="Modern search engine for web, images, videos, and files. Fast, clean, and powerful search results.">
<meta name="twitter:creator" content="@aearch">

<!-- Canonical URL -->
<link rel="canonical" href="https://aearch.netlify.app/">

<meta name="keywords" content="Aerach, search engine, 200k pages, fast search, web directory, indexed content, information discovery">
<link href="https://fonts.googleapis.com/css2?family=Product+Sans:wght@400;500;700&family=Roboto:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Roboto', sans-serif;
  background: #fff;
  color: #202124;
}

/* Header */
header {
  padding: 20px 30px;
  border-bottom: 1px solid #dadce0;
  position: sticky;
  top: 0;
  background: #fff;
  z-index: 100;
}

.header-content {
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  gap: 30px;
}

.logo {
  font-size: 22px;
  font-weight: 700;
  font-family: 'Product Sans', sans-serif;
  background: linear-gradient(90deg, #4285f4, #ea4335, #fbbc04, #34a853);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  cursor: pointer;
  white-space: nowrap;
}

.search-container {
  flex: 1;
  max-width: 700px;
  position: relative;
}

.search-box {
  display: flex;
  align-items: center;
  border: 1px solid #dfe1e5;
  border-radius: 24px;
  padding: 0 16px;
  height: 44px;
  transition: all 0.2s;
  background: #fff;
}

.search-box:hover {
  box-shadow: 0 1px 6px rgba(32,33,36,.28);
  border-color: rgba(223,225,229,0);
}

.search-box:focus-within {
  box-shadow: 0 1px 6px rgba(32,33,36,.28);
  border-color: rgba(223,225,229,0);
}

.search-icon {
  width: 20px;
  height: 20px;
  margin-right: 12px;
  opacity: 0.6;
}

.search-box input {
  flex: 1;
  border: none;
  outline: none;
  font-size: 16px;
  font-family: 'Roboto', sans-serif;
  background: transparent;
}

.clear-btn, .voice-btn {
  padding: 8px;
  cursor: pointer;
  opacity: 0.6;
  transition: opacity 0.2s;
  background: none;
  border: none;
  display: flex;
  align-items: center;
}

.clear-btn:hover, .voice-btn:hover {
  opacity: 1;
}

.tools-btn {
  padding: 8px 16px;
  border: none;
  background: transparent;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  color: #5f6368;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: background 0.2s;
}

.tools-btn:hover {
  background: #f1f3f4;
}

/* Tabs */
.tabs-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 30px;
  border-bottom: 1px solid #dadce0;
}

.tabs {
  display: flex;
  gap: 4px;
  padding-top: 8px;
}

.tab {
  padding: 12px 16px;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 14px;
  color: #5f6368;
  border-bottom: 3px solid transparent;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.tab:hover {
  color: #202124;
}

.tab.active {
  color: #1a73e8;
  border-bottom-color: #1a73e8;
}

/* Results */
.results-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px 30px;
}

.results-info {
  font-size: 14px;
  color: #70757a;
  margin-bottom: 20px;
}

/* Web Results */
.result {
  margin-bottom: 28px;
  max-width: 600px;
}

.result-url-container {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 2px;
}

.result-favicon {
  width: 18px;
  height: 18px;
  border-radius: 50%;
}

.result-url {
  font-size: 14px;
  color: #202124;
  text-decoration: none;
}

.result-breadcrumb {
  font-size: 14px;
  color: #5f6368;
  margin-left: 4px;
}

.result-title {
  font-size: 20px;
  color: #1a0dab;
  text-decoration: none;
  display: block;
  margin-bottom: 4px;
  cursor: pointer;
  line-height: 1.3;
}

.result-title:hover {
  text-decoration: underline;
}

.result-title:visited {
  color: #681da8;
}

.result-desc {
  font-size: 14px;
  color: #4d5156;
  line-height: 1.58;
}

/* Image Grid */
.image-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 16px;
  padding: 8px 0;
}

.image-card {
  cursor: pointer;
  border-radius: 12px;
  overflow: hidden;
  transition: transform 0.2s;
  background: #f8f9fa;
}

.image-card:hover {
  transform: translateY(-2px);
}

.image-wrapper {
  width: 100%;
  padding-bottom: 100%;
  position: relative;
  overflow: hidden;
  background: #f1f3f4;
}

.image-wrapper img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.image-info {
  padding: 12px;
  background: #fff;
}

.image-title {
  font-size: 14px;
  color: #202124;
  margin-bottom: 4px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.image-source {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #5f6368;
}

.image-source img {
  width: 14px;
  height: 14px;
  border-radius: 50%;
}

/* Video Results */
.video-card {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  cursor: pointer;
  max-width: 800px;
}

.video-card:hover .video-title {
  text-decoration: underline;
}

.video-thumbnail-wrapper {
  position: relative;
  width: 246px;
  height: 138px;
  flex-shrink: 0;
  border-radius: 8px;
  overflow: hidden;
  background: #000;
}

.video-thumbnail {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.video-duration {
  position: absolute;
  bottom: 6px;
  right: 6px;
  background: rgba(0,0,0,0.8);
  color: #fff;
  padding: 2px 6px;
  border-radius: 2px;
  font-size: 12px;
  font-weight: 500;
}

.video-info {
  flex: 1;
}

.video-title {
  font-size: 18px;
  color: #1a0dab;
  margin-bottom: 6px;
  line-height: 1.3;
}

.video-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.video-meta img {
  width: 16px;
  height: 16px;
  border-radius: 50%;
}

.video-meta-text {
  font-size: 13px;
  color: #5f6368;
}

.video-desc {
  font-size: 14px;
  color: #4d5156;
  line-height: 1.58;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Files */
.file-card {
  display: flex;
  gap: 12px;
  padding: 16px;
  border: 1px solid #dadce0;
  border-radius: 8px;
  margin-bottom: 12px;
  max-width: 600px;
  transition: all 0.2s;
}

.file-card:hover {
  box-shadow: 0 1px 6px rgba(32,33,36,.28);
  border-color: rgba(223,225,229,0);
}

.file-icon {
  width: 40px;
  height: 40px;
  background: #1a73e8;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 600;
  font-size: 12px;
  flex-shrink: 0;
}

.file-info {
  flex: 1;
}

.file-title {
  font-size: 16px;
  color: #1a0dab;
  text-decoration: none;
  display: block;
  margin-bottom: 4px;
}

.file-title:hover {
  text-decoration: underline;
}

.file-meta {
  font-size: 13px;
  color: #5f6368;
  display: flex;
  align-items: center;
  gap: 12px;
}

.download-btn {
  padding: 8px 16px;
  background: #1a73e8;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.2s;
}

.download-btn:hover {
  background: #1765cc;
}

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
}

.modal.active {
  display: flex;
}

.modal-content {
  max-width: 90vw;
  max-height: 90vh;
  position: relative;
}

.modal-img {
  max-width: 100%;
  max-height: 85vh;
  display: block;
  border-radius: 8px;
}

.modal-info {
  background: #fff;
  padding: 16px;
  border-radius: 0 0 8px 8px;
  max-width: 100%;
}

.modal-title {
  font-size: 16px;
  color: #202124;
  margin-bottom: 8px;
}

.modal-source {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #5f6368;
  margin-bottom: 12px;
}

.modal-source img {
  width: 16px;
  height: 16px;
  border-radius: 50%;
}

.modal-actions {
  display: flex;
  gap: 12px;
}

.modal-btn {
  padding: 8px 16px;
  border: 1px solid #dadce0;
  background: #fff;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
}

.modal-btn:hover {
  background: #f8f9fa;
}

.close-modal {
  position: absolute;
  top: -40px;
  right: 0;
  background: none;
  border: none;
  color: #fff;
  font-size: 32px;
  cursor: pointer;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.2s;
}

.close-modal:hover {
  background: rgba(255,255,255,0.1);
}

/* No Results */
.no-results {
  padding: 60px 20px;
  text-align: center;
}

.no-results-title {
  font-size: 20px;
  color: #202124;
  margin-bottom: 12px;
}

.no-results-desc {
  font-size: 14px;
  color: #5f6368;
  margin-bottom: 20px;
}

.suggestions {
  text-align: left;
  max-width: 500px;
  margin: 0 auto;
}

.suggestions li {
  margin-bottom: 8px;
  color: #5f6368;
  font-size: 14px;
}

/* Loading */
.loading {
  text-align: center;
  padding: 40px;
  font-size: 14px;
  color: #5f6368;
}

/* Filter Pills */
.filter-pills {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.filter-pill {
  padding: 8px 16px;
  background: #f1f3f4;
  border: none;
  border-radius: 16px;
  cursor: pointer;
  font-size: 13px;
  color: #3c4043;
  transition: all 0.2s;
}

.filter-pill:hover {
  background: #e8eaed;
}

.filter-pill.active {
  background: #1a73e8;
  color: #fff;
}

/* Responsive */
@media (max-width: 768px) {
  .header-content {
    flex-wrap: wrap;
  }
  
  .search-container {
    order: 3;
    width: 100%;
    max-width: 100%;
  }
  
  .image-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 8px;
  }
  
  .video-card {
    flex-direction: column;
  }
  
  .video-thumbnail-wrapper {
    width: 100%;
  }
}
</style>
</head>
<body>

<header>
  <div class="header-content">
    <div class="logo" onclick="resetSearch()">Aearch</div>
    <div class="search-container">
      <div class="search-box">
        <svg class="search-icon" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path fill="#5f6368" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
        </svg>
        <input type="text" id="searchInput" placeholder="Search" oninput="handleSearch()" onkeypress="handleKeyPress(event)">
        <button class="clear-btn" id="clearBtn" onclick="clearSearch()" style="display: none;">
          <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
            <path fill="#70757a" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
          </svg>
        </button>
        <button class="voice-btn">
          <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
            <path fill="#4285f4" d="M12 15c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v7c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.41 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"></path>
          </svg>
        </button>
      </div>
    </div>
    <button class="tools-btn">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
        <path d="M7 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zM8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
      </svg>
      Tools
    </button>
  </div>
</header>

<div class="tabs-container">
  <div class="tabs">
    <button class="tab active" data-mode="all" onclick="switchTab('all')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M10 2v2a6 6 0 0 1 6 6h2a8 8 0 0 0-8-8z"/>
        <path d="M10 4V2a8 8 0 0 0-8 8h2a6 6 0 0 1 6-6z"/>
        <path d="M4 10H2a8 8 0 0 0 8 8v-2a6 6 0 0 1-6-6z"/>
        <path d="M22 10h-2a6 6 0 0 1-6 6v2a8 8 0 0 0 8-8z"/>
      </svg>
      All
    </button>
    <button class="tab" data-mode="images" onclick="switchTab('images')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
      </svg>
      Images
    </button>
    <button class="tab" data-mode="videos" onclick="switchTab('videos')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z"/>
      </svg>
      Videos
    </button>
    <button class="tab" data-mode="files" onclick="switchTab('files')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
      </svg>
      Files
    </button>
  </div>
</div>

<div class="results-container">
  <div id="resultsInfo" class="results-info"></div>
  <div id="filterPills" class="filter-pills"></div>
  <div id="results"></div>
</div>

<!-- Image Modal -->
<div id="imageModal" class="modal" onclick="closeModal()">
  <div class="modal-content" onclick="event.stopPropagation()">
    <button class="close-modal" onclick="closeModal()">×</button>
    <img id="modalImage" class="modal-img" alt="">
    <div class="modal-info">
      <div id="modalTitle" class="modal-title"></div>
      <div id="modalSource" class="modal-source"></div>
      <div class="modal-actions">
        <button class="modal-btn" onclick="visitSource()">Visit Page</button>
        <button class="modal-btn" onclick="viewImage()">View Image</button>
      </div>
    </div>
  </div>
</div>

<script>
// Polyfills for older browsers like BlackBerry Q10
if (!Array.prototype.includes) {
  Array.prototype.includes = function(searchElement) {
    var O = Object(this);
    var len = parseInt(O.length) || 0;
    if (len === 0) return false;
    var n = parseInt(arguments[1]) || 0;
    var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);
    while (k < len) {
      if (O[k] === searchElement) return true;
      k++;
    }
    return false;
  };
}

if (!String.prototype.includes) {
  String.prototype.includes = function(search, start) {
    if (typeof start !== 'number') start = 0;
    if (start + search.length > this.length) return false;
    return this.indexOf(search, start) !== -1;
  };
}

if (!Array.prototype.filter) {
  Array.prototype.filter = function(callback, thisArg) {
    var arr = [];
    for (var i = 0; i < this.length; i++) {
      if (callback.call(thisArg, this[i], i, this)) {
        arr.push(this[i]);
      }
    }
    return arr;
  };
}

if (!Array.prototype.map) {
  Array.prototype.map = function(callback, thisArg) {
    var arr = [];
    for (var i = 0; i < this.length; i++) {
      arr.push(callback.call(thisArg, this[i], i, this));
    }
    return arr;
  };
}

if (!String.prototype.trim) {
  String.prototype.trim = function() {
    return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, '');
  };
}

if (!Array.prototype.forEach) {
  Array.prototype.forEach = function(callback, thisArg) {
    for (var i = 0; i < this.length; i++) {
      callback.call(thisArg, this[i], i, this);
    }
  };
}

// Global variables
var MODE = "all";
var PAGES = [];
var IMAGES = [];
var VIDEOS = [];
var FILES = [];
var currentQuery = "";
var currentImageData = null;

// Load data with callback for older browsers
function loadData() {
  // Load PAGES
  var xhr1 = new XMLHttpRequest();
  xhr1.open('GET', 'data.json', true);
  xhr1.onreadystatechange = function() {
    if (xhr1.readyState === 4 && xhr1.status === 200) {
      try {
        var data = JSON.parse(xhr1.responseText);
        PAGES = [];
        for (var key in data) {
          if (data.hasOwnProperty(key)) {
            PAGES.push(data[key]);
          }
        }
      } catch (e) {
        console.log("Error loading pages:", e);
      }
    }
  };
  xhr1.send();

  // Load IMAGES
  var xhr2 = new XMLHttpRequest();
  xhr2.open('GET', 'images.json', true);
  xhr2.onreadystatechange = function() {
    if (xhr2.readyState === 4 && xhr2.status === 200) {
      try {
        IMAGES = JSON.parse(xhr2.responseText);
      } catch (e) {
        console.log("Error loading images:", e);
      }
    }
  };
  xhr2.send();

  // Load VIDEOS
  var xhr3 = new XMLHttpRequest();
  xhr3.open('GET', 'videos.json', true);
  xhr3.onreadystatechange = function() {
    if (xhr3.readyState === 4 && xhr3.status === 200) {
      try {
        VIDEOS = JSON.parse(xhr3.responseText);
      } catch (e) {
        console.log("Error loading videos:", e);
      }
    }
  };
  xhr3.send();

  // Load FILES
  var xhr4 = new XMLHttpRequest();
  xhr4.open('GET', 'files.json', true);
  xhr4.onreadystatechange = function() {
    if (xhr4.readyState === 4 && xhr4.status === 200) {
      try {
        FILES = JSON.parse(xhr4.responseText);
      } catch (e) {
        console.log("Error loading files:", e);
      }
    }
  };
  xhr4.send();
}

// Initialize on page load
if (window.addEventListener) {
  window.addEventListener('load', loadData, false);
} else if (window.attachEvent) {
  window.attachEvent('onload', loadData);
} else {
  window.onload = loadData;
}

// Search handling
function handleSearch() {
  var input = document.getElementById("searchInput");
  var clearBtn = document.getElementById("clearBtn");
  currentQuery = input.value.replace(/^\s+|\s+$/g, ''); // trim for old browsers
  
  clearBtn.style.display = currentQuery ? "flex" : "none";
  
  if (currentQuery) {
    performSearch();
  } else {
    document.getElementById("results").innerHTML = "";
    document.getElementById("resultsInfo").textContent = "";
  }
}

function handleKeyPress(e) {
  e = e || window.event;
  var keyCode = e.keyCode || e.which;
  if (keyCode === 13) { // Enter key
    performSearch();
  }
}

function clearSearch() {
  document.getElementById("searchInput").value = "";
  document.getElementById("clearBtn").style.display = "none";
  document.getElementById("results").innerHTML = "";
  document.getElementById("resultsInfo").textContent = "";
  currentQuery = "";
}

function resetSearch() {
  clearSearch();
  switchTab("all");
}

// Tab switching
function switchTab(mode) {
  MODE = mode;
  var tabs = document.querySelectorAll(".tab");
  for (var i = 0; i < tabs.length; i++) {
    var tab = tabs[i];
    var tabMode = tab.getAttribute("data-mode");
    if (tabMode === mode) {
      tab.className = "tab active";
    } else {
      tab.className = "tab";
    }
  }
  
  if (currentQuery) {
    performSearch();
  }
}

// Tokenization
function tokens(s) {
  var lower = s.toLowerCase();
  var split = lower.split(/\W+/);
  var filtered = [];
  for (var i = 0; i < split.length; i++) {
    if (split[i].length > 0) {
      filtered.push(split[i]);
    }
  }
  return filtered;
}

// Scoring functions
function tokenMatchScore(text, queryTokens) {
  if (!text) return 0;
  text = text.toLowerCase();
  var score = 0;
  for (var i = 0; i < queryTokens.length; i++) {
    var qt = queryTokens[i];
    if (text.indexOf(qt) !== -1) {
      score += (qt.length <= 2 ? 5 : 10);
    } else {
      var words = text.split(/\W+/);
      for (var j = 0; j < words.length; j++) {
        var w = words[j];
        if (w.indexOf(qt) === 0 || qt.indexOf(w) === 0) {
          score += (qt.length <= 2 ? 3 : 6);
          break;
        }
      }
    }
  }
  return score;
}

function scoreWeb(p, q) {
  var qt = tokens(q);
  if (qt.length === 0) return 0;
  var score = 0;
  for (var i = 0; i < qt.length; i++) {
    var t = qt[i];
    score += tokenMatchScore(p.title || "", [t]) * 10;
    score += tokenMatchScore(p.description || "", [t]) * 2;
    score += tokenMatchScore(p.url || "", [t]) * 6;
  }
  if (p.pagerank) score += p.pagerank * 20;
  var qstr = q.toLowerCase();
  if ((p.title || "").toLowerCase().indexOf(qstr) !== -1) score += 500;
  if ((p.url || "").toLowerCase().indexOf(qstr) !== -1) score += 300;
  return score;
}

function scoreImage(i, q) {
  var qt = tokens(q);
  var score = 0;
  for (var j = 0; j < qt.length; j++) {
    var t = qt[j];
    if (t.length <= 2) {
      if ((i.img_title || "").toLowerCase().indexOf(t) !== -1) score += 5;
      if ((i.page_title || "").toLowerCase().indexOf(t) !== -1) score += 3;
    } else {
      score += tokenMatchScore(i.img_title || "", [t]) * 10;
      score += tokenMatchScore(i.page_title || "", [t]) * 4;
      score += tokenMatchScore(i.page_url || "", [t]) * 2;
    }
  }
  return score;
}

function scoreVideo(v, q) {
  var qt = tokens(q);
  var score = 0;
  for (var j = 0; j < qt.length; j++) {
    var t = qt[j];
    if (t.length <= 2) {
      if ((v.video_title || "").toLowerCase().indexOf(t) !== -1) score += 5;
      if ((v.page_title || "").toLowerCase().indexOf(t) !== -1) score += 3;
    } else {
      score += tokenMatchScore(v.video_title || "", [t]) * 10;
      score += tokenMatchScore(v.page_title || "", [t]) * 4;
    }
  }
  return score;
}

function scoreFile(f, q) {
  var qt = tokens(q);
  var score = 0;
  for (var j = 0; j < qt.length; j++) {
    var t = qt[j];
    if (t.length <= 2) {
      if ((f.file_title || "").toLowerCase().indexOf(t) !== -1) score += 5;
      if ((f.page_title || "").toLowerCase().indexOf(t) !== -1) score += 3;
    } else {
      score += tokenMatchScore(f.file_title || "", [t]) * 10;
      score += tokenMatchScore(f.page_title || "", [t]) * 4;
    }
  }
  return score;
}

// Perform search
function performSearch() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  
  if (!currentQuery) {
    results.innerHTML = "";
    resultsInfo.textContent = "";
    return;
  }
  
  results.innerHTML = '<div class="loading">Searching...</div>';
  
  setTimeout(function() {
    if (MODE === "all") {
      searchAll();
    } else if (MODE === "images") {
      searchImages();
    } else if (MODE === "videos") {
      searchVideos();
    } else if (MODE === "files") {
      searchFiles();
    }
  }, 100);
}

// Helper function for number formatting
function formatNumber(num) {
  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

// Search All
function searchAll() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  results.innerHTML = "";
  
  var scored = [];
  for (var i = 0; i < PAGES.length; i++) {
    var p = PAGES[i];
    var s = scoreWeb(p, currentQuery);
    if (s > 0) scored.push({ p: p, s: s });
  }
  
  scored.sort(function(a, b) { return b.s - a.s; });
  
  if (scored.length === 0) {
    showNoResults();
    return;
  }
  
  resultsInfo.textContent = "About " + formatNumber(scored.length) + " results";
  
  var seenDomains = {};
  for (var i = 0; i < scored.length; i++) {
    var r = scored[i];
    var p = r.p;
    
    // Simple URL parsing for older browsers
    var parser = document.createElement('a');
    parser.href = p.url;
    var hostname = parser.hostname;
    var domain = hostname.replace('www.', '');
    
    if (seenDomains[domain]) continue;
    seenDomains[domain] = true;
    
    var pathname = parser.pathname;
    var pathParts = pathname.split('/');
    var breadcrumbParts = [];
    for (var j = 0; j < pathParts.length && j < 3; j++) {
      if (pathParts[j]) breadcrumbParts.push(pathParts[j]);
    }
    var breadcrumb = breadcrumbParts.join(' › ');
    
    var result = document.createElement("div");
    result.className = "result";
    
    var favicon = p.favicon || 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>';
    
    result.innerHTML = 
      '<div class="result-url-container">' +
        '<img class="result-favicon" src="' + favicon + '" onerror="this.src=\'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>\'">' +
        '<span class="result-url">' + domain + '</span>' +
        (breadcrumb ? '<span class="result-breadcrumb">› ' + breadcrumb + '</span>' : '') +
      '</div>' +
      '<a href="' + p.url + '" target="_blank" class="result-title">' + (p.title || p.url) + '</a>' +
      '<div class="result-desc">' + (p.description || '') + '</div>';
    
    results.appendChild(result);
    
    var domainCount = 0;
    for (var key in seenDomains) {
      if (seenDomains.hasOwnProperty(key)) domainCount++;
    }
    if (domainCount >= 20) break;
  }
}

// Search Images
function searchImages() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  results.innerHTML = "";
  
  var scored = [];
  for (var i = 0; i < IMAGES.length; i++) {
    var img = IMAGES[i];
    var s = scoreImage(img, currentQuery);
    if (s > 0) scored.push({ i: img, s: s });
  }
  
  scored.sort(function(a, b) { return b.s - a.s; });
  
  if (scored.length === 0) {
    showNoResults();
    return;
  }
  
  resultsInfo.textContent = "About " + formatNumber(scored.length) + " image results";
  
  var grid = document.createElement("div");
  grid.className = "image-grid";
  
  var seenDomains = {};
  for (var j = 0; j < scored.length; j++) {
    var r = scored[j];
    var img = r.i;
    
    var parser = document.createElement('a');
    parser.href = img.page_url;
    var domain = parser.hostname.replace('www.', '');
    
    if (seenDomains[domain]) continue;
    seenDomains[domain] = true;
    
    var card = document.createElement("div");
    card.className = "image-card";
    card.setAttribute('data-img-url', img.img_url);
    card.setAttribute('data-img-title', img.img_title || img.page_title || 'Untitled');
    card.setAttribute('data-page-url', img.page_url);
    card.setAttribute('data-page-favicon', img.page_favicon || '');
    
    var favicon = img.page_favicon || 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>';
    
    card.innerHTML = 
      '<div class="image-wrapper">' +
        '<img src="' + img.img_url + '" alt="' + (img.img_title || '') + '" loading="lazy">' +
      '</div>' +
      '<div class="image-info">' +
        '<div class="image-title">' + (img.img_title || img.page_title || 'Untitled') + '</div>' +
        '<div class="image-source">' +
          '<img src="' + favicon + '" onerror="this.src=\'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>\'">' +
          '<span>' + domain + '</span>' +
        '</div>' +
      '</div>';
    
    card.onclick = function() {
      var imgUrl = this.getAttribute('data-img-url');
      var imgTitle = this.getAttribute('data-img-title');
      var pageUrl = this.getAttribute('data-page-url');
      var pageFavicon = this.getAttribute('data-page-favicon');
      openImageModal({
        img_url: imgUrl,
        img_title: imgTitle,
        page_url: pageUrl,
        page_favicon: pageFavicon
      });
    };
    
    grid.appendChild(card);
    
    var domainCount = 0;
    for (var key in seenDomains) {
      if (seenDomains.hasOwnProperty(key)) domainCount++;
    }
    if (domainCount >= 40) break;
  }
  
  results.appendChild(grid);
}

// Search Videos
function searchVideos() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  results.innerHTML = "";
  
  var scored = [];
  for (var i = 0; i < VIDEOS.length; i++) {
    var v = VIDEOS[i];
    var s = scoreVideo(v, currentQuery);
    if (s > 0) scored.push({ v: v, s: s });
  }
  
  scored.sort(function(a, b) { return b.s - a.s; });
  
  if (scored.length === 0) {
    showNoResults();
    return;
  }
  
  resultsInfo.textContent = "About " + formatNumber(scored.length) + " video results";
  
  var seenDomains = {};
  for (var j = 0; j < scored.length; j++) {
    var r = scored[j];
    var v = r.v;
    
    var parser = document.createElement('a');
    parser.href = v.page_url;
    var domain = parser.hostname.replace('www.', '');
    
    if (seenDomains[domain]) continue;
    seenDomains[domain] = true;
    
    var card = document.createElement("div");
    card.className = "video-card";
    card.setAttribute('data-video-url', v.video_url);
    card.onclick = function() {
      window.open(this.getAttribute('data-video-url'), '_blank');
    };
    
    var favicon = v.page_favicon || 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>';
    
    card.innerHTML = 
      '<div class="video-thumbnail-wrapper">' +
        '<img class="video-thumbnail" src="' + (v.thumbnail || '') + '" alt="' + (v.video_title || '') + '">' +
        '<span class="video-duration">12:34</span>' +
      '</div>' +
      '<div class="video-info">' +
        '<div class="video-title">' + (v.video_title || v.page_title || 'Untitled Video') + '</div>' +
        '<div class="video-meta">' +
          '<img src="' + favicon + '" onerror="this.src=\'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>\'">' +
          '<span class="video-meta-text">' + domain + '</span>' +
        '</div>' +
        '<div class="video-desc">' + (v.page_title || 'Watch this video') + '</div>' +
      '</div>';
    
    results.appendChild(card);
    
    var domainCount = 0;
    for (var key in seenDomains) {
      if (seenDomains.hasOwnProperty(key)) domainCount++;
    }
    if (domainCount >= 20) break;
  }
}

// Search Files
function searchFiles() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  results.innerHTML = "";
  
  var scored = [];
  for (var i = 0; i < FILES.length; i++) {
    var f = FILES[i];
    var s = scoreFile(f, currentQuery);
    if (s > 0) scored.push({ f: f, s: s });
  }
  
  scored.sort(function(a, b) { return b.s - a.s; });
  
  if (scored.length === 0) {
    showNoResults();
    return;
  }
  
  resultsInfo.textContent = "About " + formatNumber(scored.length) + " file results";
  
  var seenDomains = {};
  for (var j = 0; j < scored.length; j++) {
    var r = scored[j];
    var f = r.f;
    
    var parser = document.createElement('a');
    parser.href = f.page_url;
    var domain = parser.hostname.replace('www.', '');
    
    if (seenDomains[domain]) continue;
    seenDomains[domain] = true;
    
    var urlParts = f.file_url.split('.');
    var ext = urlParts[urlParts.length - 1].toUpperCase();
    if (ext.length > 4) ext = ext.substring(0, 4);
    
    var card = document.createElement("div");
    card.className = "file-card";
    
    card.innerHTML = 
      '<div class="file-icon">' + ext + '</div>' +
      '<div class="file-info">' +
        '<a href="' + f.file_url + '" target="_blank" class="file-title">' + (f.file_title || f.file_url) + '</a>' +
        '<div class="file-meta">' +
          '<span>' + domain + '</span>' +
          '<span>•</span>' +
          '<span>' + ext + ' file</span>' +
        '</div>' +
      '</div>' +
      '<button class="download-btn" onclick="event.stopPropagation(); window.open(\'' + f.file_url + '\', \'_blank\')">' +
        'Download' +
      '</button>';
    
    results.appendChild(card);
    
    var domainCount = 0;
    for (var key in seenDomains) {
      if (seenDomains.hasOwnProperty(key)) domainCount++;
    }
    if (domainCount >= 20) break;
  }
}

// Image Modal
function openImageModal(imageData) {
  currentImageData = imageData;
  var modal = document.getElementById("imageModal");
  var modalImg = document.getElementById("modalImage");
  var modalTitle = document.getElementById("modalTitle");
  var modalSource = document.getElementById("modalSource");
  
  modalImg.src = imageData.img_url;
  modalTitle.textContent = imageData.img_title || imageData.page_title || 'Untitled';
  
  var parser = document.createElement('a');
  parser.href = imageData.page_url;
  var domain = parser.hostname.replace('www.', '');
  
  var favicon = imageData.page_favicon || 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22 fill=%22%23ddd%22/></svg>';
  
  modalSource.innerHTML = 
    '<img src="' + favicon + '">' +
    '<span>' + domain + '</span>';
  
  modal.className = "modal active";
}

function closeModal() {
  var modal = document.getElementById("imageModal");
  modal.className = "modal";
}

function visitSource() {
  if (currentImageData) {
    window.open(currentImageData.page_url, '_blank');
  }
}

function viewImage() {
  if (currentImageData) {
    window.open(currentImageData.img_url, '_blank');
  }
}

// No Results
function showNoResults() {
  var results = document.getElementById("results");
  var resultsInfo = document.getElementById("resultsInfo");
  
  resultsInfo.textContent = "";
  
  results.innerHTML = 
    '<div class="no-results">' +
      '<div class="no-results-title">No results found for "' + currentQuery + '"</div>' +
      '<div class="no-results-desc">Try different keywords or check your spelling</div>' +
      '<div class="suggestions">' +
        '<p style="font-weight: 500; margin-bottom: 8px;">Suggestions:</p>' +
        '<ul>' +
          '<li>Make sure all words are spelled correctly</li>' +
          '<li>Try different keywords</li>' +
          '<li>Try more general keywords</li>' +
          '<li>Try fewer keywords</li>' +
        '</ul>' +
      '</div>' +
    '</div>';
}

// Keyboard shortcuts
function handleKeyDown(e) {
  e = e || window.event;
  var keyCode = e.keyCode || e.which;
  var target = e.target || e.srcElement;
  
  // Press / to focus search
  if (keyCode === 191 && target.tagName !== 'INPUT') { // / key
    if (e.preventDefault) e.preventDefault();
    else e.returnValue = false;
    document.getElementById('searchInput').focus();
  }
  
  // Press Escape to close modal
  if (keyCode === 27) { // Escape key
    var modal = document.getElementById('imageModal');
    if (modal.className.indexOf('active') !== -1) {
      closeModal();
    }
  }
}

if (document.addEventListener) {
  document.addEventListener('keydown', handleKeyDown, false);
} else if (document.attachEvent) {
  document.attachEvent('onkeydown', handleKeyDown);
}
</script>
</body>
</html>


